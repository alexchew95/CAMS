<!doctype html>
<html lang="en" dir="ltr">

<head>
	<meta charset="UTF-8">
	<meta name="viewport"
		content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<meta http-equiv="Content-Language" content="en" />
	<meta name="msapplication-TileColor" content="#2d89ef">
	<meta name="theme-color" content="#4188c9">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="mobile-web-app-capable" content="yes">
	<meta name="HandheldFriendly" content="True">
	<meta name="MobileOptimized" content="320">
	<link rel="icon" href="./favicon.ico" type="image/x-icon" />
	<link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />
	<!-- Generated: 2018-04-06 16:27:42 +0200 -->
	<title>CAMS - Home</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet"
		href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300i,400,400i,500,500i,600,600i,700,700i&amp;subset=latin-ext">
	
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	<!-- <script src="//geodata.solutions/includes/countrystatecity.js"></script> -->
	<!-- <script src="./assets/js/firebase.js"></script> -->
	<script src="https://www.gstatic.com/firebasejs/7.0.0/firebase.js"></script>
	<script src="./assets/js/require.min.js"></script>
	<!-- <script src="https://www.gstatic.com/firebasejs/7.0.0/firebase.js"></script> -->
	
	
	

	<script>
		requirejs.config({
			baseUrl: '.'
		});

	</script>
	<!--Needed for JQuery Modal
	TODO: think how to move it to requireJS-->

	<!-- this JQEUERY had to be here in order for modal to work -->
	<!-- Dashboard Core -->
	<link href="./assets/css/dashboard.css" rel="stylesheet" />
	<script src="./assets/js/dashboard.js"></script>
	<!-- jQuery Modal CSS-->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />

</head>
<div class="custom-loader"></div>

<body class="">
	<div class="page">
		<div class="page-main">
			<div class="header py-4">
				<div class="container" id="topbar">
					<!--Header to auto load here-->
				</div>
			</div>

			<div class="header collapse d-lg-flex p-0" id="headerMenuCollapse">
				<div class="container" id="navbar">

				</div>
			</div>

			<div class="my-3 my-md-5">
				<div class="container">

					<div class="page-header">
						<h1 class="page-title">
							Personal Information
						</h1>
					</div>

					<fieldset class="form-fieldset" id="add_Journal_Info">
							<div class="form-group">
									<label class="form-label">Name:</label><div id = "name"></div>
									
								</div>
								<div class="form-group">
										<label class="form-label">Email:</label><div id = "email"></div>
										
									</div>
						<form id="Add_Journal_Info">
							<div class="form-group">
								<label class="form-label">Upload Profile Picture:</label>
								<div class="custom-file">
									
									<input type="file" value="upload" id="fileButton" name="files[]" accept="image/*" data-type="image"/>
								
								</div>
							</div>
							<br />
							<br />
							<div class="btn-list">
								<a href="#" id="add" class="btn btn-success" type="submit">Save changes</a>
								<button href='#' onclick="window.history.back()" class="btn btn-danger">Back</button>
							</div>
						</form>
					</fieldset>

				</div>

			</div>


		</div>
		<div class="footer">

		</div>
		<footer class="footer">
			<div class="container">
				<div class="row align-items-center flex-row-reverse">
					<div class="col-auto ml-lg-auto">
						<div class="row align-items-center">

						</div>
					</div>
					<div class="col-12 col-lg-auto mt-3 mt-lg-0 text-center">
						Copyright Â© 2018
						<a href=".">CAMS Sdn Bhd</a>. Theme by
						<a href="https://tentspark.com" target="_blank">tenstpark</a> All rights reserved.
					</div>
				</div>
			</div>
		</footer>
	</div>




	<script type="text/javascript">
		require(['mainjs', 'twbs', 'modal'], function () {

			//When the page has loaded.
			// $(document).ready(function () {
				
				// firebase.auth().onAuthStateChanged(function(user){
				// 	if (user) {
				// 		// User is signed in.
				// 		var db = firebase.firestore();//API firestore database
				// 		console.log(firebase.auth().currentUser.user)
						
						
				// 	} else {
				// 		// No user is signed in.
				// 	}

				// });

				document.getElementById("name").innerHTML = sessionStorage.getItem("name");
				document.getElementById("email").innerHTML = sessionStorage.getItem("email");



$("#add").click(function(){
	console.log("test")
	
})
				var fileButton = document.getElementById('fileButton');

				fileButton.addEventListener('change', function (e) {
					console.log("button")
					//get file
					var file = e.target.files[0];
					

					//create a storage ref
					var storage = firebase.storage();
					var storageRef = storage.ref();
					var mountainImagesRef = storageRef.child('users-profile/' + uid + 'jpg');


					//upload file
					mountainImagesRef.put(file).then(function (snapshot) {
						snapshot.ref.getDownloadURL().then(function(downloadURL) {
							console.log("File available at", downloadURL);
							//get uid from sessionStorage
							var username = sessionStorage.getItem("uid");
							var Photo = downloadURL;
							var obj = new Object();
							obj.Photo = Photo;

							var db = firebase.firestore();
							db.collection("Users").doc(firebase.auth().currentUser.uid).update({
								Photo: downloadURL,
							});
							
							
						
						});
						console.log("upload success")
						//window.location = "home.html";
					});

				
				});



			});





	

	</script>
</body>

</html>