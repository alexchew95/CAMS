<!doctype html>
<html lang="en" dir="ltr">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<meta http-equiv="Content-Language" content="en" />
	<meta name="msapplication-TileColor" content="#2d89ef">
	<meta name="theme-color" content="#4188c9">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="mobile-web-app-capable" content="yes">
	<meta name="HandheldFriendly" content="True">
	<meta name="MobileOptimized" content="320">
	<link rel="icon" href="./favicon.ico" type="image/x-icon" />
	<link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />
	<!-- Generated: 2018-04-06 16:27:42 +0200 -->
	<title>LPTS - Add Package</title>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js"></script>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,300i,400,400i,500,500i,600,600i,700,700i&amp;subset=latin-ext">
	<script src="./assets/js/require.min.js"></script>

	<script>
		requirejs.config({
			baseUrl: '.'
		});

	</script>
	<!-- Dashboard Core -->
	<link href="./assets/css/dashboard.css" rel="stylesheet" />
	<script src="./assets/js/dashboard.js"></script>

	<!-- jQuery Modal -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />
	<!--Datatable CSS-->
	<link href="./assets/css/datatables.min.css" rel="stylesheet" />
	<!--JqueryUi CSS-->
	<link href="./assets/css/jquery-ui.min.css" rel="stylesheet" />

</head>

<body class="">
	<div class="page">
		<div class="page-main">
			<div class="header py-4">
				<div class="container" id="topbar">

				</div>
			</div>
			<div class="header collapse d-lg-flex p-0" id="headerMenuCollapse">
				<div class="container" id="navbar">

				</div>
			</div>

			<div class="my-3 my-md-5">
				<div class="container">
					<nav aria-label="breadcrumb">
						<ol class="breadcrumb">
							<li class="breadcrumb-item">
								<a href="home.html">Home</a>
							</li>
							<li class="breadcrumb-item">
								<a href="customer.html">Customer</a>
							</li>
							<li class="breadcrumb-item active" aria-current="page">Add Customer</li>
						</ol>
					</nav>
					<form>
						<!-- TOP ROW before Tabs-->
						<div class="form-horizontal">
							<div style="display:inline;">
								<table>
									<div class="col-sm-12 col-md-12">
										<div class="form-group">
											<tr>
												<td>
													<label class="col-form-label float-right">Name*</label>
												</td>
												<td>
													<input type="text" id="Name" class="form-control" autocomplete="off" maxlength="100" required>
												</td>
											</tr>
										</div>
									</div>

									<div class="col-sm-12 col-md-12">
										<div class="form-group">
											<tr>
												<td>
													<label class="col-form-label float-right">Marketing Officer* </label>
												</td>
												<td>
													<input type="text" id="MarketingOfficer" class="form-control" autocomplete="off" maxlength="100" readonly required>
													<input type="hidden" id="MarketingOfficerId" value="">
												</td>
											</tr>
										</div>
									</div>

									<div class="col-sm-12 col-md-12">
										<div class="form-group">
											<tr>
												<td>
													<label class="col-form-label float-right">Package* </label>
												</td>
												<td>
													<select type="form-control custom-select" id="Package" class="form-control" maxlength="100" required>
														<option value="0">- Select One-</option>
														<option value="1">MAB-CS-3-85%</option>
														<option value="2">MAB-CS-4-90%</option>
														<option value="3">Gemilang-BR</option>
														<option value="4">Kobeta-BR-5.99%</option>
														<option value="5">Konsumer-Br</option>
														<option value="6">KopMinda-CS</option>
														<option value="7">Kospek-Contract</option>
														<option value="8">KOSPEM-BR-TETAP</option>
														<option value="9">Kowamas</option>
														<option value="10">PBB-MCCM</option>
														<option value="11">RHB-Govt</option>
														<option value="12">Ukhwah-MBB-5.59%</option>
													</select>
												</td>
											</tr>
										</div>
									</div>
								</table>
							</div>
						</div>
						<br>
					</form>
				</div>


			</div>


		</div>

	</div>

	<div class="footer">

	</div>
	<footer class="footer">
		<div class="container">
			<div class="row align-items-center flex-row-reverse">
				<div class="col-auto ml-lg-auto">
					<div class="row align-items-center">
						<!-- <div class="col-auto">
                <ul class="list-inline list-inline-dots mb-0">
                  <li class="list-inline-item">
                    <a href="./docs/index.html">Documentation</a>
                  </li>
                  <li class="list-inline-item">
                    <a href="./faq.html">FAQ</a>
                  </li>
                </ul>
              </div> -->
						<!-- <div class="col-auto">
                <a href="https://github.com/tabler/tabler" class="btn btn-outline-primary btn-sm">Source code</a>
              </div> -->
					</div>
				</div>
				<div class="col-12 col-lg-auto mt-3 mt-lg-0 text-center">
					Copyright Â© 2018
					<a href=".">LPTS Sdn Bhd</a>. Theme by
					<a href="https://tentspark.com" target="_blank">tenstpark</a> All rights reserved.
				</div>
			</div>
		</div>
	</footer>
	</div>

	<script type="text/javascript">
		/////* Declare variables */////

		token = sessionStorage.getItem("token");
		require(['mainjs'], function () {

			$("#SaveAndStay").click(function (event) {
				event.preventDefault();
				if (checkValidity()) {
					addCustomer();
				}
			});

			$("#Save").click(function (event) {
				if (checkValidity()) {
					if (addCustomer()) {
						window.location = "customer.html";
					}
				}
			});

			$("#Cancel").click(function (event) {
				window.location = "customer.html";
			});

			function checkValidity() {
				data = ["Name", "MarketingOfficer", "Package", "Status", "EntryDate", "ICNo", "DateOfBirth", "CompanyName",
					"Salary", "Deduction", "EligibleDeduction", "LoanApplied", "Tenure", "ProfitRate", "Bank", "AccountNo"
				];

				var datalength = data.length,
					comma = true,
					validInp = true,
					reqField = "",
					inp,
					inpValue;

				for (var i = 0; i < datalength; i++) {
					inp = document.getElementById(data[i]);
					if ((data[i] == "Package") || (data[i] == "Status") || (data[i] == "EligibleDeduction") || (data[i] == "Bank")) {
						inpValue = document.getElementById(data[i]).value;
						if (inpValue == 0) {
							if (comma) {
								reqField += (data[i]);
								comma = false;
								validInp = false;
							} else {
								reqField += (", " + data[i]);
							}
						}
					} else {
						if (!inp.checkValidity()) {
							if (comma) {
								reqField += (data[i]);
								comma = false;
								validInp = false;
							} else {
								reqField += (", " + data[i]);
							}
						}
					}
					if (validInp == false) {
						$("#lblMessages").text("Please fill up for " + reqField);
					} else {
						$("#lblMessages").text("");
					}
				}
				return validInp;
			}

			function addCustomer() {
				$.ajax({
					url: APIUrl + 'addCustomer',
					type: 'POST',
					dataType: 'JSON',
					beforeSend: function (xhr) { //Include the bearer token in header
						xhr.setRequestHeader("Authorization", token);
					},
					data: {
						"customerName": $("#Name").val(),
						"marketingOfficerId": $("#MarketingOfficerId").val(),
						"packageId": $("#Package").val(),
						"status": $("#Status").val(),
						"entryDate": $("#EntryDate").val(),
						"newIC": $("#ICNo").val(),
						"oldIC": $("#OldICNo").val(),
						"dob": $("#DateOfBirth").val(),
						"gender": $("#Gender").val(),
						"phoneNumber": $("#MobilePhoneNo").val(),
						"email": $("#Email").val(),
						"nextContactName": $("#NextContactName").val(),
						"nextContactRel": $("#NextContactRelationship").val(),
						"nextContactPhone": $("#NextContactPhoneNo").val(),
						"nextContactOfficePhone": $("#NextContactOfficePhoneNo").val(),
						"addr1": $("#HomeAddressLine1").val(),
						"addr2": $("#HomeAddressLine2").val(),
						"city": $("#HomeAddressCity").val(),
						"postCode": $("#HomeAddressPostCode").val(),
						"state": $("#HomeAddressState").val(),
						"homePhone": $("#HomePhoneNo").val(),
						"companyName": $("#CompanyName").val(),
						"position": $("#Position").val(),
						"officePhone": $("#OfficePhoneNo").val(),
						"faxNumber": $("#FaxPhoneNo").val(),
						"compAddr1": $("#CompanyAddressLine1").val(),
						"compAddr2": $("#CompanyAddressLine2").val(),
						"compCity": $("#CompanyAddressCity").val(),
						"compPostCode": $("#CompanyAddressPostCode").val(),
						"compState": $("#CompanyAddressState").val(),
						"CompanyPhoneNo": $("#CompanyPhoneNo").val(),
						"salary": $("#Salary").val(),
						"allowance": $("#Allowance").val(),
						"deduction": $("#Deduction").val(),
						"inTransit": $("#InTransit").val(),
						"amtBooked": $("#AmountBooked").val(),
						"payslipMonth": $("#PayslipMonth").val(),
						"installment": $("#Installment").val(),
						"eligibleDeduction": $("#EligibleDeduction").val(),
						"loanAppliedAmt": $("#LoanApplied").val(),
						"tenure": $("#Tenure").val(),
						"profitRate": $("#ProfitRate").val(),
						"approvalCode": $("#ApprovalCode").val(),
						"loanApprovedAmt": $("#LoanApproved").val(),
						"invoiceAmt": $("#InvoiceAmount").val(),
						"approvalDate": $("#ApprovalDate").val(),
						"netLoanApproved": $("#NetLoanApproved").val(),
						"settleOwnLoan": $("#SettleOwnLoan").val(),
						"marketingOfficerAdv": $("#MarketingOfficerAdvance").val(),
						"companyAdv": $("#CompanyAdvance").val(),
						"commissionDeductionAmt": $("#CommissionDeductionAmount").val(),
						"bankId": $("#Bank").val(),
						"bankInName": $("#BankInName").val(),
						"bankAcctNo": $("#AccountNo").val(),
						"bankInAmt": $("#BankInAmmount").val(),
						"bankInDate": $("#BankInDate").val(),
						"chequeNo": $("#BankChequeNo").val(),
						"reconciliationDate": $("#ReconciliationDate").val(),
						"dateToBank": $("#DateToBank").val(),
						"bankRef": $("#BankReference").val(),
						"commissionDeductionSettlement": $("#CommissionDeductionSettlement").val(),
						"Attention_MarketingOfficer": $("#Attention_MarketingOfficer").val(),
						"Attention_Company": $("#Attention_Company").val(),
						"remarkContent": $("#NewRemark").val(),
					},

					// to do API.php user, createDateTime, completeUser, completeDateTime, completeDateTime

					success: function (data) {
						alert("Customer add succesful.");
						return true;
					},

					error: function () {
						alert("Customer add fail.");
						return false;
					}
				});
			}

			$(document).ready(function () {
				// Load datepicker
				require(['jquery', 'jqueryui'], function ($) {
					$(function () {
						var d = new Date().getDate();
						var m = new Date().getMonth() + 1; // JavaScript months are 0-11
						var y = new Date().getFullYear();
						$("[id$=EntryDate]").val(y + "-" + m + "-" + d);
						$("[id$=EntryDate]").datepicker({
							weekStart: 1,
							dateFormat: 'yy-mm-dd'
						});

						$(".datepicker").datepicker({
							changeMonth: true,
							changeYear: true,
							dateFormat: 'yy-mm-dd',
							yearRange: '1900:' + y
						});
					});
				});

				var name = sessionStorage.getItem("name");
				var userId = sessionStorage.getItem("userId");
				$("#MarketingOfficer").attr("placeholder", name);
				$("#MarketingOfficerId").val(userId);


			});
		});

	</script>
</body>

</html>
